import{j as r,r as u,b as j,u as F,H as k}from"./app-D9K0lIg2.js";import{A as H}from"./app-layout-DjmuWQS6.js";import{d as L,e as I}from"./index-CoNroDVL.js";import{B as p}from"./button-Cq0MOVKo.js";import{P as K,a as O,b as U,c as $}from"./popover-DKDeY4ci.js";import{S as B,T as M}from"./trash-C3FSZoTg.js";import{D as R,a as V,b as z,c as G}from"./dialog-66DR-adO.js";import{I as _}from"./input-Cdacpup9.js";import{L as S}from"./label-CiFHFGZU.js";import{S as J,a as W,b as X,c as Y,d as w}from"./select-DEmj677Q.js";import{q as v,a as A}from"./index-CMWG4mbA.js";import{D as Z}from"./datatable-BVwayNB8.js";import{S as ee,A as te}from"./pagination-Dd8pkajb.js";import{P as re}from"./placeholder-pattern-DEgDWVpB.js";import{d as ae}from"./index-BJM0ycyN.js";/* empty css            */import"./index-Ct_SG2XW.js";import"./index-BSy4OLH8.js";import"./index-BeC5lqBz.js";import"./app-img-logo-DWWu-s2u.js";import"./index-C9Rp0xoA.js";import"./chevron-down-bs4vnQC5.js";import"./check-C5X-y35h.js";import"./chevron-left-BV2a4pwW.js";function ne({openEdit:e,deleteDept:t}){return[{accessorKey:"id",header:"ID",cell:({row:a})=>r.jsx("div",{className:"text-sm text-muted-foreground",children:a.original.id})},{accessorKey:"name",header:"ชื่อหน่วยงาน",cell:({row:a})=>r.jsx("div",{className:"font-medium text-foreground",children:a.original.name})},{accessorKey:"short_name",header:"ชื่อย่อ",cell:({row:a})=>r.jsx("div",{className:"text-sm text-muted-foreground",children:a.original.short_name||"-"})},{accessorKey:"parent.name",header:"แผนกหลัก",cell:({row:a})=>r.jsx("div",{className:"text-sm",children:a.original.parent?.name||"— ไม่มี —"})},{id:"actions",header:"",enableHiding:!1,cell:({row:a})=>{const m=a.original;return r.jsxs(K,{children:[r.jsx(O,{asChild:!0,children:r.jsx(p,{size:"icon",variant:"ghost",className:"h-8 w-8","aria-label":"Actions",children:"⋯"})}),r.jsxs(U,{className:"p-0 w-auto",align:"end",children:[r.jsxs(p,{variant:"ghost",className:"w-full justify-start px-3 py-2 hover:bg-muted",onClick:()=>e(m),children:[r.jsx(B,{className:"mr-2 h-4 w-4"}),"แก้ไข"]}),r.jsx($,{asChild:!0,children:r.jsxs(p,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-destructive hover:bg-muted",onClick:()=>t(m.id),children:[r.jsx(M,{className:"mr-2 h-4 w-4"}),"ลบ"]})})]})]})}}]}const l=e=>({url:l.url(e),method:"post"});l.definition={methods:["post"],url:"/department"};l.url=e=>l.definition.url+v(e);l.post=e=>({url:l.url(e),method:"post"});const q=e=>({action:l.url(e),method:"post"});q.post=e=>({action:l.url(e),method:"post"});l.form=q;const s=(e,t)=>({url:s.url(e,t),method:"get"});s.definition={methods:["get","head"],url:"/department/{department}"};s.url=(e,t)=>{(typeof e=="string"||typeof e=="number")&&(e={department:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={department:e.id}),Array.isArray(e)&&(e={department:e[0]}),e=A(e);const a={department:typeof e.department=="object"?e.department.id:e.department};return s.definition.url.replace("{department}",a.department.toString()).replace(/\/+$/,"")+v(t)};s.get=(e,t)=>({url:s.url(e,t),method:"get"});s.head=(e,t)=>({url:s.url(e,t),method:"head"});const N=(e,t)=>({action:s.url(e,t),method:"get"});N.get=(e,t)=>({action:s.url(e,t),method:"get"});N.head=(e,t)=>({action:s.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"HEAD",...t?.query??t?.mergeQuery??{}}}),method:"get"});s.form=N;const o=(e,t)=>({url:o.url(e,t),method:"put"});o.definition={methods:["put","patch"],url:"/department/{department}"};o.url=(e,t)=>{(typeof e=="string"||typeof e=="number")&&(e={department:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={department:e.id}),Array.isArray(e)&&(e={department:e[0]}),e=A(e);const a={department:typeof e.department=="object"?e.department.id:e.department};return o.definition.url.replace("{department}",a.department.toString()).replace(/\/+$/,"")+v(t)};o.put=(e,t)=>({url:o.url(e,t),method:"put"});o.patch=(e,t)=>({url:o.url(e,t),method:"patch"});const D=(e,t)=>({action:o.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...t?.query??t?.mergeQuery??{}}}),method:"post"});D.put=(e,t)=>({action:o.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...t?.query??t?.mergeQuery??{}}}),method:"post"});D.patch=(e,t)=>({action:o.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...t?.query??t?.mergeQuery??{}}}),method:"post"});o.form=D;const d=(e,t)=>({url:d.url(e,t),method:"delete"});d.definition={methods:["delete"],url:"/department/{department}"};d.url=(e,t)=>{(typeof e=="string"||typeof e=="number")&&(e={department:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={department:e.id}),Array.isArray(e)&&(e={department:e[0]}),e=A(e);const a={department:typeof e.department=="object"?e.department.id:e.department};return d.definition.url.replace("{department}",a.department.toString()).replace(/\/+$/,"")+v(t)};d.delete=(e,t)=>({url:d.url(e,t),method:"delete"});const P=(e,t)=>({action:d.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...t?.query??t?.mergeQuery??{}}}),method:"post"});P.delete=(e,t)=>({action:d.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...t?.query??t?.mergeQuery??{}}}),method:"post"});d.form=P;const g={store:Object.assign(l,l),show:Object.assign(s,s),update:Object.assign(o,o),destroy:Object.assign(d,d)};function se({open:e,onOpenChange:t,departmentData:a,parents:m=[]}){const[f,y]=u.useState("create"),[i,c]=u.useState({name:"",short_name:"",parent_id:""});u.useEffect(()=>{a?(y("edit"),c({name:a.name||"",short_name:a.short_name||"",parent_id:a.parent_id?.toString()||""})):(y("create"),c({name:"",short_name:"",parent_id:""}))},[a]);const x=n=>{n.preventDefault(),f==="create"?j.post(g.store().url,i,{onSuccess:()=>t(!1)}):a&&j.put(g.update(a.id).url,i,{onSuccess:()=>t(!1)})};return r.jsx(R,{open:e,onOpenChange:t,children:r.jsxs(V,{className:"max-w-md",children:[r.jsx(z,{children:r.jsx(G,{children:f==="create"?"เพิ่มหน่วยงาน":"แก้ไขหน่วยงาน"})}),r.jsxs("form",{onSubmit:x,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(S,{htmlFor:"name",children:"ชื่อหน่วยงาน"}),r.jsx(_,{id:"name",name:"name",value:i.name,onChange:n=>c({...i,name:n.target.value}),required:!0})]}),r.jsxs("div",{children:[r.jsx(S,{htmlFor:"short_name",children:"ชื่อย่อ"}),r.jsx(_,{id:"short_name",name:"short_name",value:i.short_name,onChange:n=>c({...i,short_name:n.target.value})})]}),r.jsxs("div",{children:[r.jsx(S,{htmlFor:"parent_id",children:"แผนกหลัก"}),r.jsxs(J,{value:i.parent_id||"none",onValueChange:n=>c({...i,parent_id:n==="none"?"":n}),children:[r.jsx(W,{children:r.jsx(X,{placeholder:"เลือกแผนกหลัก (ถ้ามี)"})}),r.jsxs(Y,{children:[r.jsx(w,{value:"none",children:"— ไม่มี —"}),m.map(n=>r.jsx(w,{value:n.id.toString(),children:n.name},n.id))]})]})]}),r.jsxs("div",{className:"flex justify-end gap-2",children:[r.jsx(p,{type:"button",variant:"outline",onClick:()=>t(!1),children:"ยกเลิก"}),r.jsx(p,{type:"submit",children:f==="create"?"บันทึก":"อัปเดต"})]})]})]})})}const oe=[{title:"Dashboard",href:L().url},{title:"Repository",href:I().url},{title:"Position",href:""}];function Te(){const{rows:e,filters:t,parents:a}=F().props,[m,f]=u.useState(t?.search||""),[y,i]=u.useState(!1),[c,x]=u.useState(null),[n,b]=u.useState(!1),C=ne({openEdit:async h=>{b(!0);const T=await(await fetch(g.show(h).url)).json();x(T)},deleteDept:h=>{confirm("ต้องการลบหน่วยงานนี้หรือไม่?")&&j.delete(g.destroy(h).url)}}),E=()=>{j.get(ae.index().url,{search:m},{preserveState:!0,replace:!0,onStart:()=>i(!0),onFinish:()=>i(!1)})};return r.jsxs(H,{breadcrumbs:oe,children:[r.jsx(k,{title:"Department Management"}),r.jsxs("div",{className:"flex justify-between items-center p-4",children:[r.jsx("h2",{className:"text-lg font-semibold",children:"ฝ่าย"}),r.jsx(p,{onClick:()=>{b(!0),x(null)},children:"เพิ่มหน่วยงาน"})]}),r.jsxs("div",{className:"p-4 flex gap-2",children:[r.jsx(_,{type:"search",placeholder:"ค้นหาชื่อหน่วยงาน...",value:m,onChange:h=>f(h.target.value)}),r.jsx(p,{onClick:E,children:"ค้นหา"})]}),y?r.jsx("div",{className:"p-4 space-y-3",children:Array.from({length:10}).map((h,Q)=>r.jsx(ee,{className:"h-8 w-full"},Q))}):e?r.jsxs("div",{className:"p-4",children:[r.jsx(Z,{columns:C,data:e.data}),r.jsx("div",{className:"mt-6",children:r.jsx(te,{links:e.links})})]}):r.jsx("div",{className:"flex justify-center items-center h-40",children:r.jsx(re,{className:"h-24 w-24 text-muted-foreground"})}),r.jsx(se,{open:n,onOpenChange:b,departmentData:c,parents:a})]})}export{Te as default};
