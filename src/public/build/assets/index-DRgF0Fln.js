import{j as r,r as c,b as v,u as H,H as I}from"./app-D9K0lIg2.js";import{d as K}from"./index-CoNroDVL.js";import{A as O,s as U}from"./app-layout-DjmuWQS6.js";import{B as m}from"./button-Cq0MOVKo.js";import{P as $,a as B,b as M,c as V}from"./popover-DKDeY4ci.js";import{S as z,T as R}from"./trash-C3FSZoTg.js";import{P as G}from"./placeholder-pattern-DEgDWVpB.js";import{D as J}from"./datatable-BVwayNB8.js";import{S as W,A as X}from"./pagination-Dd8pkajb.js";import{I as g}from"./input-Cdacpup9.js";import{D as Y,a as Z,b as ee,c as te,d as re}from"./dialog-66DR-adO.js";import{L as j}from"./label-CiFHFGZU.js";import{S as se,a as ae,b as oe,c as ie,d as le}from"./select-DEmj677Q.js";import{d as ne}from"./index-BJM0ycyN.js";import{q as S,a as A}from"./index-CMWG4mbA.js";import{C as de}from"./circle-plus-CoWCO5BP.js";/* empty css            */import"./index-Ct_SG2XW.js";import"./index-BSy4OLH8.js";import"./index-BeC5lqBz.js";import"./app-img-logo-DWWu-s2u.js";import"./chevron-left-BV2a4pwW.js";import"./index-C9Rp0xoA.js";import"./chevron-down-bs4vnQC5.js";import"./check-C5X-y35h.js";function ce({openEdit:e,deleteStaff:t}){return[{accessorKey:"id",header:"ID",cell:({row:s})=>r.jsx("div",{className:"text-sm text-muted-foreground",children:s.original.id})},{accessorKey:"name",header:"ชื่อ-สกุล",cell:({row:s})=>r.jsx("div",{className:"font-medium text-foreground",children:s.original.name})},{accessorKey:"position",header:"ตำแหน่ง",cell:({row:s})=>r.jsx("div",{className:"text-sm",children:s.original.position||"-"})},{accessorKey:"department",header:"หน่วยงาน",cell:({row:s})=>r.jsx("div",{className:"text-sm",children:s.original.department||"-"})},{accessorKey:"email",header:"อีเมล",cell:({row:s})=>r.jsx("div",{className:"text-sm text-muted-foreground",children:s.original.email||"-"})},{accessorKey:"phone",header:"เบอร์โทร",cell:({row:s})=>r.jsx("div",{className:"text-sm text-muted-foreground",children:s.original.phone||"-"})},{id:"actions",header:"",enableHiding:!1,cell:({row:s})=>{const f=s.original;return r.jsxs($,{children:[r.jsx(B,{asChild:!0,children:r.jsx(m,{size:"icon",variant:"ghost",className:"h-8 w-8",children:"⋯"})}),r.jsxs(M,{className:"p-0 w-auto",align:"end",children:[r.jsxs(m,{variant:"ghost",className:"w-full justify-start px-3 py-2 hover:bg-muted",onClick:()=>e(f),children:[r.jsx(z,{className:"mr-2 h-4 w-4"}),"แก้ไข"]}),r.jsx(V,{asChild:!0,children:r.jsxs(m,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-destructive hover:bg-muted",onClick:()=>t(f.id),children:[r.jsx(R,{className:"mr-2 h-4 w-4"}),"ลบ"]})})]})]})}}]}const l=e=>({url:l.url(e),method:"post"});l.definition={methods:["post"],url:"/staff"};l.url=e=>l.definition.url+S(e);l.post=e=>({url:l.url(e),method:"post"});const D=e=>({action:l.url(e),method:"post"});D.post=e=>({action:l.url(e),method:"post"});l.form=D;const o=(e,t)=>({url:o.url(e,t),method:"get"});o.definition={methods:["get","head"],url:"/staff/{staff}"};o.url=(e,t)=>{(typeof e=="string"||typeof e=="number")&&(e={staff:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={staff:e.id}),Array.isArray(e)&&(e={staff:e[0]}),e=A(e);const s={staff:typeof e.staff=="object"?e.staff.id:e.staff};return o.definition.url.replace("{staff}",s.staff.toString()).replace(/\/+$/,"")+S(t)};o.get=(e,t)=>({url:o.url(e,t),method:"get"});o.head=(e,t)=>({url:o.url(e,t),method:"head"});const w=(e,t)=>({action:o.url(e,t),method:"get"});w.get=(e,t)=>({action:o.url(e,t),method:"get"});w.head=(e,t)=>({action:o.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"HEAD",...t?.query??t?.mergeQuery??{}}}),method:"get"});o.form=w;const i=(e,t)=>({url:i.url(e,t),method:"put"});i.definition={methods:["put","patch"],url:"/staff/{staff}"};i.url=(e,t)=>{(typeof e=="string"||typeof e=="number")&&(e={staff:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={staff:e.id}),Array.isArray(e)&&(e={staff:e[0]}),e=A(e);const s={staff:typeof e.staff=="object"?e.staff.id:e.staff};return i.definition.url.replace("{staff}",s.staff.toString()).replace(/\/+$/,"")+S(t)};i.put=(e,t)=>({url:i.url(e,t),method:"put"});i.patch=(e,t)=>({url:i.url(e,t),method:"patch"});const C=(e,t)=>({action:i.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...t?.query??t?.mergeQuery??{}}}),method:"post"});C.put=(e,t)=>({action:i.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PUT",...t?.query??t?.mergeQuery??{}}}),method:"post"});C.patch=(e,t)=>({action:i.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"PATCH",...t?.query??t?.mergeQuery??{}}}),method:"post"});i.form=C;const n=(e,t)=>({url:n.url(e,t),method:"delete"});n.definition={methods:["delete"],url:"/staff/{staff}"};n.url=(e,t)=>{(typeof e=="string"||typeof e=="number")&&(e={staff:e}),typeof e=="object"&&!Array.isArray(e)&&"id"in e&&(e={staff:e.id}),Array.isArray(e)&&(e={staff:e[0]}),e=A(e);const s={staff:typeof e.staff=="object"?e.staff.id:e.staff};return n.definition.url.replace("{staff}",s.staff.toString()).replace(/\/+$/,"")+S(t)};n.delete=(e,t)=>({url:n.url(e,t),method:"delete"});const T=(e,t)=>({action:n.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...t?.query??t?.mergeQuery??{}}}),method:"post"});T.delete=(e,t)=>({action:n.url(e,{[t?.mergeQuery?"mergeQuery":"query"]:{_method:"DELETE",...t?.query??t?.mergeQuery??{}}}),method:"post"});n.form=T;const N={store:Object.assign(l,l),show:Object.assign(o,o),update:Object.assign(i,i),destroy:Object.assign(n,n)};function fe({open:e,onOpenChange:t,staffData:s}){const[f,y]=c.useState("create"),[h,P]=c.useState([]),[d,p]=c.useState({id:0,staff_code:"",full_name:"",position_id:null,department_id:null,active:!0});c.useEffect(()=>{fetch(ne.index().url+"?json=1").then(a=>a.json()).then(P)},[]),c.useEffect(()=>{s?(y("edit"),p({id:s.id,staff_code:s.staff_code||"",full_name:s.full_name||"",position_id:s.position_id||null,department_id:s.department_id||null,active:s.active??!0})):(y("create"),p({id:0,staff_code:"",full_name:"",position_id:null,department_id:null,active:!0}))},[s]);const x=a=>{const{name:Q,value:q}=a.target;p(_=>({..._,[Q]:q}))},b=a=>{if(a.preventDefault(),f==="create")v.post(N.store().url,d,{onSuccess:()=>t(!1)});else{if(!s)return;v.put(N.update(s.id).url,d,{onSuccess:()=>t(!1)})}};return r.jsx(Y,{open:e,onOpenChange:t,children:r.jsxs(Z,{className:"max-w-md",children:[r.jsxs(ee,{children:[r.jsx(te,{children:f==="create"?"➕ เพิ่มเจ้าหน้าที่ใหม่":"✏️ แก้ไขข้อมูลเจ้าหน้าที่"}),r.jsx(re,{className:"sr-only",children:"หน้าต่างยืนยันการลบข้อมูล ใช้เพื่อยืนยันก่อนลบจริง"})]}),r.jsxs("form",{onSubmit:b,className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx(j,{htmlFor:"staff_code",children:"รหัสพนักงาน"}),r.jsx(g,{id:"staff_code",name:"staff_code",value:d.staff_code,onChange:x})]}),r.jsxs("div",{children:[r.jsx(j,{htmlFor:"full_name",children:"ชื่อ-สกุล"}),r.jsx(g,{id:"full_name",name:"full_name",value:d.full_name,onChange:x,required:!0})]}),r.jsxs("div",{children:[r.jsx(j,{htmlFor:"position",children:"ตำแหน่ง"}),r.jsx(g,{id:"position",name:"position",value:d.position,onChange:x})]}),r.jsxs("div",{children:[r.jsx(j,{children:"ฝ่าย"}),r.jsxs(se,{value:d.department_id?.toString()??"",onValueChange:a=>p({...d,department_id:a?parseInt(a):null}),children:[r.jsx(ae,{children:r.jsx(oe,{placeholder:"เลือกหน่วยงาน"})}),r.jsx(ie,{children:h.map(a=>r.jsx(le,{value:a.id.toString(),children:a.name},a.id))})]})]}),r.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[r.jsx(m,{type:"button",variant:"outline",onClick:()=>t(!1),children:"ยกเลิก"}),r.jsx(m,{type:"submit",children:f==="create"?"บันทึกข้อมูล":"อัปเดตข้อมูล"})]})]})]})})}const ue=[{title:"Dashboard",href:K().url}];function Ie(){const{rows:e,filters:t}=H().props,[s,f]=c.useState(t?.search||""),[y,h]=c.useState(!1),[P,d]=c.useState(!1),[p,x]=c.useState(null),[b,a]=c.useState(!1),_=ce({openEdit:async u=>{d(!0),a(!0);try{const L=await(await fetch(N.show(u).url)).json();x(L)}finally{d(!1)}},deleteStaff:u=>{confirm("Are you sure you want to delete this staff?")}}),F=u=>{u&&v.get(u,{},{preserveState:!0,preserveScroll:!0,replace:!0,onStart:()=>h(!0),onFinish:()=>h(!1)})},k=()=>{v.get(U.index().url,{search:s},{preserveState:!0,replace:!0,onStart:()=>h(!0),onFinish:()=>h(!1)})};return r.jsxs(O,{breadcrumbs:ue,children:[r.jsx(I,{title:"Staff Management"}),r.jsx("div",{className:"flex h-full flex-1 flex-col gap-4 overflow-x-auto rounded-xl p-4",children:r.jsxs("div",{className:"relative min-h-[100vh] flex-1 overflow-hidden rounded-xl border border-sidebar-border/70 md:min-h-min dark:border-sidebar-border",children:[r.jsxs("div",{className:"flex gap-2 p-4",children:[r.jsxs(m,{onClick:()=>{a(!0),x(null)},variant:"outline",children:[r.jsx(de,{})," New"]}),r.jsx(g,{type:"search",placeholder:"Search staff...",value:s,className:"lg:w-xs w-full",onChange:u=>f(u.target.value)}),r.jsx(m,{onClick:k,children:"Search"})]}),y?r.jsx("div",{className:"p-4 space-y-3",children:Array.from({length:10}).map((u,E)=>r.jsx(W,{className:"h-8 w-full"},E))}):e?r.jsxs("div",{className:"p-4",children:[r.jsx(J,{columns:_,data:e.data}),r.jsx("div",{className:"mt-6",children:r.jsx(X,{links:e.links,onPageChange:F})})]}):r.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:r.jsx(G,{className:"h-24 w-24 text-muted-foreground"})})]})}),r.jsx(fe,{open:b,onOpenChange:a,staffData:p})]})}export{Ie as default};
